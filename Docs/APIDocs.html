<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Detailed Documentation of SESM APIs">
    <meta name="author" content="Rémy GRANDIN">
    <title>SESM APIs Documentation</title>

    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>

    <style>
        @media (min-width: 1200px) {
            .container {
                width: 90%;
            }
        }
        /*-- Method Summary Table --*/

        .summaryTable tr td:hover {
            cursor: pointer;
        }

        .summaryTable tr *:nth-child(1) {
            width: 20%;
        }

        .summaryTable tr *:nth-child(2) {
            width: 8%;
            text-align: center;
        }

        /*-- Response Code Table --*/

        .codeTable tr *:nth-child(1) {
            width: 20%;
        }

        .codeTable tr *:nth-child(2) {
            width: 8%;
            text-align: center;
        }

        /*-- Response Table --*/

        .responseTable tr *:nth-child(1) {
            width: 20%;
        }

        .responseTable tr *:nth-child(2) {
            width: 8%;
            text-align: center;
        }

        .responseTable tr td:nth-child(2) {
            color: blue;
        }

        /*-- POST Parameters Table --*/

        .postTable tr *:nth-child(1) {
            width: 20%;
        }

        .postTable tr *:nth-child(2) {
            width: 8%;
            text-align: center;
        }

        .postTable tr td:nth-child(2) {
            color: blue;
        }

        .postTable tr *:nth-child(3) {
            width: 3%;
            text-align: center;
        }

        /*-- Titles --*/
        h2 {
            width: 80%;
            border-bottom: 4px dashed steelblue;
            padding-bottom: 5px;
        }

        h3 {
            width: 50%;
            border-bottom: 4px dashed gray;
            padding-bottom: 5px;
        }

        h4 {
            width: 30%;
            border-bottom: 4px dashed lightgray;
            padding-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="col-md-12">
            <div class="page-header">
                <h1>SESM APIs Documentation</h1>
                <p class="lead">Detailed Documentation of SESM APIs.</p>
            </div>

            <h2 id="AccountAPI">Account API</h2>
            <p>This API provide methods to manage user authentication and profile.</p>
            <p>
                Base URL : <em>/API/Account/</em>
            </p>
            <h3>Methods Summary</h3>
            <table class="table table-hover table-striped summaryTable" id="summaryAccountAPI">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>GetChallenge</td>
                        <td>GET</td>
                        <td>Provide a one use challenge for the authentication process.</td>
                    </tr>
                    <tr>
                        <td>LogOut</td>
                        <td>GET</td>
                        <td>Log out the current user.</td>
                    </tr>
                    <tr>
                        <td>Authenticate</td>
                        <td>POST</td>
                        <td>Authenticate a user with login/password crendentials.</td>
                    </tr>
                    <tr>
                        <td>Register</td>
                        <td>POST</td>
                        <td>Register a new user.</td>
                    </tr>
                    <tr>
                        <td>GetDetails</td>
                        <td>GET</td>
                        <td>Get the current user profile details.</td>
                    </tr>
                    <tr>
                        <td>SetDetails</td>
                        <td>POST</td>
                        <td>Set the current user profile details.</td>
                    </tr>
                </tbody>
            </table>

            <h3 id="AccountAPI-GetChallenge">GetChallenge</h3>
            <p>
                Type : <em>GET</em><br />
                URL : <em>/API/Account/GetChallenge</em><br />
                This web service return a one use challenge needed for the SESM authentication process.<br />
                For more information, see <a href="#AccountAPI-Authenticate" class="autoScroll">Authenticate</a>.
            </p>
            <h4>Successful Response Content</h4>
            <p>A MD5 Type String, acting as a challenge.</p>

            <h4>Response Codes</h4>
            <table class="table table-hover table-striped codeTable">
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ACT-GC-OK</td>
                        <td>Success</td>
                        <td>The challenge was successfuly generated.</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response Exemple</h4>
            <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;
&lt;Response&gt;
    &lt;Type&gt;Success&lt;/Type&gt;
    &lt;Timestamp&gt;2015-03-23T01:59:01.0460013+01:00&lt;/Timestamp&gt;
    &lt;ReturnCode&gt;ACT-GC-OK&lt;/ReturnCode&gt;
    &lt;Content&gt;b6d7726b257ba48a6c90667fb8cd2e29&lt;/Content&gt;
&lt;/Response&gt;</code></pre>

            <h3 id="AccountAPI-LogOut">LogOut</h3>
            <p>
                Type : <em>GET</em><br />
                URL : <em>/API/Account/LogOut</em><br />
                This web service will log out the current user.
            </p>

            <h4>Response Codes</h4>
            <table class="table table-hover table-striped codeTable">
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ACT-LGO-NOTLOG</td>
                        <td>Warning</td>
                        <td>No user is logged in.</td>
                    </tr>
                    <tr>
                        <td>ACT-LGO-OK</td>
                        <td>Success</td>
                        <td>The current user has been logged out.</td>
                    </tr>
                </tbody>
            </table>

            <h3 id="AccountAPI-Authenticate">Authenticate</h3>
            <p>
                Type : <em>POST</em><br />
                URL : <em>/API/Account/Authenticate</em><br />
                This web service provide a way to authenticate a user.<br />
                The process is sligtly different from a standard login/password form submit authentication.<br />
                <ol>
                    <li>Call the <a href="#AccountAPI-GetChallenge" class="autoScroll">GetChallenge</a> API to obtain a one use challenge string</li>
                    <li>Calculate the challenge response as folow : <var>SHA1(challenge + MD5(User_Password))</var></li>
                    <li>Call the Authenticate API with the User login and the calculated challenge response</li>
                </ol>
            </p>

            <h4>POST Parameters</h4>
            <table class="table table-hover table-striped postTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Opt.</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Login</td>
                        <td>String</td>
                        <td></td>
                        <td>The user's login.</td>
                    </tr>
                    <tr>
                        <td>Password</td>
                        <td>String</td>
                        <td></td>
                        <td>The challenge encoded password.</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response Codes</h4>
            <table class="table table-hover table-striped codeTable">
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ACT-ATH-ALRLOG</td>
                        <td>Error</td>
                        <td>A user is already logged in.</td>
                    </tr>
                    <tr>
                        <td>ACT-ATH-EXPCHLNG</td>
                        <td>Error</td>
                        <td>The server challenge has expired or haven't been generated.</td>
                    </tr>
                    <tr>
                        <td>ACT-ATH-MISLGN</td>
                        <td>Error</td>
                        <td>The Login field must be provided.</td>
                    </tr>
                    <tr>
                        <td>ACT-ATH-MISPWD</td>
                        <td>Error</td>
                        <td>The Password field must be provided.</td>
                    </tr>
                    <tr>
                        <td>ACT-ATH-FAIL</td>
                        <td>Error</td>
                        <td>The provided login/password are incorrect.</td>
                    </tr>
                    <tr>
                        <td>ACT-ATH-OK</td>
                        <td>Success</td>
                        <td>The user has been authenticated.</td>
                    </tr>
                </tbody>
            </table>

            <h3 id="AccountAPI-Register">Register</h3>
            <p>
                Type : <em>POST</em><br />
                URL : <em>/API/Account/Register</em><br />
                This web service provide a way to register a new user.<br />
                It should only be used as a user way to create an account.
                To create a user as admin, see <a href="#UserAPI-CreateUser" class="autoScroll">CreateUser</a>.
            </p>

            <h4>POST Parameters</h4>
            <table class="table table-hover table-striped postTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Opt.</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Login</td>
                        <td>String</td>
                        <td></td>
                        <td>The user's login.</td>
                    </tr>
                    <tr>
                        <td>Password</td>
                        <td>String</td>
                        <td></td>
                        <td>The password's MD5.</td>
                    </tr>
                    <tr>
                        <td>Email</td>
                        <td>String</td>
                        <td></td>
                        <td>The user's email.</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response Codes</h4>
            <table class="table table-hover table-striped codeTable">
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ACT-REG-ALRLOG</td>
                        <td>Error</td>
                        <td>A user is already logged in.</td>
                    </tr>
                    <tr>
                        <td>ACT-REG-MISLGN</td>
                        <td>Error</td>
                        <td>The Login field must be provided.</td>
                    </tr>
                    <tr>
                        <td>ACT-REG-MISPWD</td>
                        <td>Error</td>
                        <td>The Password field must be provided.</td>
                    </tr>
                    <tr>
                        <td>ACT-REG-BADPWD</td>
                        <td>Error</td>
                        <td>The password is not a valid MD5.</td>
                    </tr>
                    <tr>
                        <td>ACT-REG-MISEML</td>
                        <td>Error</td>
                        <td>The Email field must be provided.</td>
                    </tr>
                    <tr>
                        <td>ACT-REG-BADEML</td>
                        <td>Error</td>
                        <td>The email is not valid.</td>
                    </tr>
                    <tr>
                        <td>ACT-REG-USREXI</td>
                        <td>Error</td>
                        <td>User already exist.</td>
                    </tr>
                    <tr>
                        <td>ACT-REG-OK</td>
                        <td>Success</td>
                        <td>The user has been registered successfuly.</td>
                    </tr>
                </tbody>
            </table>

            <h3 id="AccountAPI-GetDetails">GetDetails</h3>
            <p>
                Type : <em>GET</em><br />
                URL : <em>/API/Account/GetDetails</em><br />
                This web service return the current user account details.
            </p>

            <h4>Successful Response Content</h4>
            <p>The following propeties :</p>
            <table class="table table-hover table-striped responseTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Login</td>
                        <td>String</td>
                        <td>The user's login.</td>
                    </tr>
                    <tr>
                        <td>Email</td>
                        <td>String</td>
                        <td>The user's email.</td>
                    </tr>
                    <tr>
                        <td>IsSuperAdmin</td>
                        <td>Boolean</td>
                        <td>true if the user is a super administrator, false if he isn't.</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response Codes</h4>
            <table class="table table-hover table-striped codeTable">
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ACT-GTD-NOTLOG</td>
                        <td>Warning</td>
                        <td>No user is logged in.</td>
                    </tr>
                    <tr>
                        <td>ACT-GTD-OK</td>
                        <td>Success</td>
                        <td>The detail have been successfuly retrived.</td>
                    </tr>
                </tbody>
            </table>

            <h3 id="AccountAPI-SetDetails">SetDetails</h3>
            <p>
                Type : <em>POST</em><br />
                URL : <em>/API/Account/SetDetails</em><br />
                This web service provide a way to change the current user's account details.
            </p>

            <h4>POST Parameters</h4>
            <table class="table table-hover table-striped postTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Opt.</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Login</td>
                        <td>String</td>
                        <td></td>
                        <td>The user's login.</td>
                    </tr>
                    <tr>
                        <td>Email</td>
                        <td>String</td>
                        <td></td>
                        <td>The user's email.</td>
                    </tr>
                    <tr>
                        <td>OldPassword</td>
                        <td>String</td>
                        <td><span class="glyphicon glyphicon-ok-circle"></span></td>
                        <td>The old password's MD5. Provide only if you want to change the current user's password. Required if you provide NewPassword</td>
                    </tr>
                    <tr>
                        <td>NewPassword</td>
                        <td>String</td>
                        <td><span class="glyphicon glyphicon-ok-circle"></span></td>
                        <td>The new password's MD5. Provide only if you want to change the current user's password. Required if you provide OldPassword</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response Codes</h4>
            <table class="table table-hover table-striped codeTable">
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ACT-STD-NOTLOG</td>
                        <td>Error</td>
                        <td>No user is logged in.</td>
                    </tr>
                    <tr>
                        <td>ACT-STD-MISLGN</td>
                        <td>Error</td>
                        <td>The Login field must be provided.</td>
                    </tr>
                    <tr>
                        <td>ACT-STD-MISEML</td>
                        <td>Error</td>
                        <td>The EMail field must be provided.</td>
                    </tr>
                    <tr>
                        <td>ACT-STD-MISPWD</td>
                        <td>Error</td>
                        <td>One of OldPassword or NewPassword has been provided but not the other.</td>
                    </tr>
                    <tr>
                        <td>ACT-STD-USREXI</td>
                        <td>Error</td>
                        <td>The user new login is already in use.</td>
                    </tr>
                    <tr>
                        <td>ACT-STD-BADOPWD</td>
                        <td>Error</td>
                        <td>The old password is not a valid MD5.</td>
                    </tr>
                    <tr>
                        <td>ACT-STD-BADNPWD</td>
                        <td>Error</td>
                        <td>The new password is not a valid MD5.</td>
                    </tr>
                    <tr>
                        <td>ACT-STD-OPWDMIS</td>
                        <td>Error</td>
                        <td>The provided old password mismatch with the stored one.</td>
                    </tr>
                    <tr>
                        <td>ACT-STD-BADEML</td>
                        <td>Error</td>
                        <td>The email provided is not valid.</td>
                    </tr>
                    <tr>
                        <td>ACT-STD-OK</td>
                        <td>Success</td>
                        <td>The user account have been updated.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <script>
        $(function () {
            hljs.initHighlightingOnLoad();
            $('a.autoScroll').click(function () {
                var href = $.attr(this, 'href');
                console.log(href);
                $('html, body').animate({
                    scrollTop: $(href).offset().top
                }, 1000, function () {
                    window.location.hash = href;
                });
                return false;
            });

            $(".summaryTable tr td").click(function () {
                var item = $(this);
                var id = item.parents("table").attr("id");
                id = "#" + id.substr(7) + "-" + item.parents("tr").children(":nth-child(1)").text();
                $('html, body').animate({
                    scrollTop: $(id).offset().top
                }, 1000, function () {
                    window.location.hash = id;
                });

            });

            // === Formating ===

            // Method name bold
            $(".summaryTable, .codeTable, .postTable").find("td:nth-child(1)").each(function () {
                var item = $(this);
                item.html('<strong>' + item.html() + '</strong>');
            });

            // GET / POST Label Formating
            $(".summaryTable").find("td:nth-child(2)").each(function () {
                var item = $(this);

                switch (item.text()) {
                    case "GET":
                        item.html('<span class="label label-success">GET</span>');
                        break;
                    case "POST":
                        item.html('<span class="label label-primary">POST</span>');
                        break;
                }
            });

            // GET / POST Label Formating
            $(".codeTable").find("td:nth-child(2)").each(function () {
                var item = $(this);

                switch (item.text()) {
                    case "Success":
                        item.html('<span class="label label-success">Success</span>');
                        break;
                    case "Warning":
                        item.html('<span class="label label-warning">Warning</span>');
                        break;
                    case "Error":
                        item.html('<span class="label label-danger">Error</span>');
                        break;
                }
            });
        });
    </script>
</body>
</html>