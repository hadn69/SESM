@{
    ViewBag.Title = "File Explorer";

    List<KeyValuePair<string, string>> breadCrumb = new List<KeyValuePair<string, string>>();
    breadCrumb.Add(new KeyValuePair<string, string>("Servers", "/Servers/"));
    breadCrumb.Add(new KeyValuePair<string, string>(ViewBag.Server.Name, "/Servers/Dashboard/" + ViewBag.ServerID));
    breadCrumb.Add(new KeyValuePair<string, string>("File Explorer", "/Explorer/Browse/" + ViewBag.ServerID));
    ViewBag.Breadcrumb = breadCrumb;

    ViewBag.RefreshBtn = true;
}
<link rel="stylesheet" type="text/css" href="/assets/global/plugins/jstree/dist/themes/default/style.min.css">
<script src="/assets/global/plugins/jstree/dist/jstree.min.js"></script>
<script src="/assets/global/plugins/datatables/media/js/jquery.dataTables.min.js" type="text/javascript"></script>
<script src="/assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="/assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css" />
<div class="col-md-5">
    <div class="portlet light" style="height: 400px">
        <div class="portlet-body" style="height: 100%">
            <div id="treeDiv" style="overflow: auto; height:100%">
            </div>
        </div>
    </div>
</div>
<div class="col-md-7">
    <div class="portlet light" style="height: 400px">
        <div class="portlet-body" style="height: 100%">
            <div class="table-scrollable">
                <table id="tableDiv" class="table table-striped">
                    <thead>
                        <tr>
                            <th class=" table-checkbox">
                                <input type="checkbox" class="group-checkable" data-set="#sample_1 .checkboxes" />
                            </th>
                            <th>
                                Username
                            </th>
                            <th>
                                Email
                            </th>
                            <th>
                                Points
                            </th>
                            <th>
                                Joined
                            </th>
                            <th>
                                Status
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                shuxer
                            </td>
                            <td>
                                <a href="mailto:shuxer@gmail.com">
                                    shuxer@gmail.com
                                </a>
                            </td>
                            <td>
                                120
                            </td>
                            <td class="center">
                                12 Jan 2012
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                toop
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                17.12.2010
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                toop
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                17.12.2010
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                toop
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                17.12.2010
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                toop
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                17.12.2010
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                toop
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                17.12.2010
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                toop
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                17.12.2010
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                weep
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                15.11.2011
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                weep
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                15.11.2011
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                weep
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                15.11.2011
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                weep
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                15.11.2011
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                weep
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                15.11.2011
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                weep
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                15.11.2011
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                weep
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                15.11.2011
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                weep
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                15.11.2011
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                        <tr class="odd gradeX">
                            <td>
                                <input type="checkbox" class="checkboxes" value="1" />
                            </td>
                            <td>
                                weep
                            </td>
                            <td>
                                <a href="mailto:userwow@gmail.com">
                                    good@gmail.com
                                </a>
                            </td>
                            <td>
                                20
                            </td>
                            <td class="center">
                                15.11.2011
                            </td>
                            <td>
                                <span class="label label-sm label-success">
                                    Approved
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    function initPage() {
        function fileSizeIEC(a, b, c, d, e) {
            return (b = Math, c = b.log, d = 1024, e = c(a) / c(d) | 0, a / b.pow(d, e)).toFixed(2)
                + ' ' + (e ? 'KMGTPEZY'[--e] + 'B' : 'Bytes');
        }
        function isEmptyOrSpaces(str) {
            return str === null || str.match(/^\s*$/) !== null;
        }

        var currentPath = "";
        var currentNode = null;

        $('#tableDiv').dataTable({
            "scrollY": "200px",
            "paging": false,
            "searching": false,
            "info": false,
        });

        $("#treeDiv").jstree({
            "plugins": ["types", "sort", "wholerow"],
            "core": {
                "themes": {
                    "responsive": false
                },
                "check_callback": true,
                'data': function (obj, cb) {
                    // Root case
                    if (obj.id == "#") {
                        cb.call(this, [{ text: "\\", id: "rootNode", children: true }]);
                        return;
                    }
                    // Getting the path
                    var path = "";
                    if (obj.id != "#") {
                        path = $('#treeDiv').jstree(true).get_path(obj, "\\").substring(2);
                    }

                    // Calling for data
                    $.post("/API/Explorer/GetDirectoryDirectories/",
                    {
                        ServerID: serverID,
                        Path: path
                    },
                    function (data, status) {
                        var root = $($.parseXML(data)).find("Response");

                        if (root.children("Type").text() == "Error") {
                            toastr.error(root.children("Content").text(), "Error " + root.children("ReturnCode").text());
                            cb.call(this, new Array());
                            return;
                        }
                        var dirArray = new Array();
                        root.children("Content").first().children("Item").each(function (index) {
                            dirArray.push({ text: $(this).children("Name").first().text(), children: true });
                        });
                        cb.call(this, dirArray);
                    });
                }
            },
            "types": {
                "default": {
                    "icon": "fa fa-folder icon-state-warning icon-lg"
                }
            }
        });
    }
</script>
